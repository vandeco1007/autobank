{"ast":null,"code":"import dateValue from '../constant/date';\nconst bankLogin = (user, password) => {\n  var myHeaders = new Headers();\n  myHeaders.append(\"Authorization\", btoa(user + \":\" + password));\n  var requestOptions = {\n    method: 'GET',\n    headers: myHeaders,\n    redirect: 'follow'\n  };\n  if (user == 'admin' && password == 'admin') {\n    localStorage.setItem('role', 'admin');\n  } else {\n    fetch(\"http://localhost:8090/TotalControl/v2/login\", requestOptions).then(response => response.json()).then(result => {\n      if (result.status == true) {\n        console.log(result.value.token);\n        localStorage.setItem('bankUser', user);\n        localStorage.setItem('bankToken', result.value.token);\n        fetch(\"http://localhost:8090/TotalControl/v2/devices?q=all&token=\" + result.value.token, requestOptions).then(response => response.json()).then(result => {\n          console.log(result.ids);\n          let loginContainer = document.getElementsByClassName('bankLoginForm')[0];\n          document.getElementsByClassName('bankLoginForm')[0].innerHTML = \"\";\n          result.ids.forEach(item => {\n            let button = document.createElement('button');\n            let device = document.createTextNode(item);\n            button.appendChild(device);\n            button.setAttribute('id', item);\n            button.setAttribute('class', 'chooseDevices');\n            loginContainer.appendChild(button);\n            button.addEventListener('click', function () {\n              localStorage.setItem('deviceName', button.getAttribute('id'));\n              if (!localStorage.getItem(button.getAttribute('id'))) {\n                localStorage.setItem(button.getAttribute('id'), 0);\n              }\n              setTimeout(function () {\n                window.location.href = '/';\n              }, 500);\n            });\n          });\n        }).catch(error => console.log('error', error));\n        // window.location.reload()\n      } else {\n        localStorage.setItem('bankUser', \"Vui Long Dang Nhap Lai\");\n        alert(\"Đăng Nhập Không Chính Xác\");\n        window.location.reload();\n      }\n    }).catch(error => console.log('error', error));\n  }\n};\nexport default bankLogin;\n// 48bbd5f5a95477f3053c28b73bce2f20","map":{"version":3,"names":["dateValue","bankLogin","user","password","myHeaders","Headers","append","btoa","requestOptions","method","headers","redirect","localStorage","setItem","fetch","then","response","json","result","status","console","log","value","token","ids","loginContainer","document","getElementsByClassName","innerHTML","forEach","item","button","createElement","device","createTextNode","appendChild","setAttribute","addEventListener","getAttribute","getItem","setTimeout","window","location","href","catch","error","alert","reload"],"sources":["C:/Users/789bet/Desktop/789bet/Vietin/src/api/bankLogin.js"],"sourcesContent":["import dateValue from '../constant/date'\r\nconst bankLogin = (user,password)=>{\r\n  var myHeaders = new Headers();\r\n  myHeaders.append(\"Authorization\", btoa(user+\":\"+password));\r\n  var requestOptions = {\r\n    method: 'GET',\r\n    headers: myHeaders,\r\n    redirect: 'follow'\r\n  };\r\n  if(user=='admin' && password=='admin'){\r\n    localStorage.setItem('role','admin')\r\n  }else{\r\n    fetch(\"http://localhost:8090/TotalControl/v2/login\", requestOptions)\r\n    .then(response => response.json())\r\n    .then(result =>{\r\n      if(result.status==true){\r\n        console.log(result.value.token)\r\n        localStorage.setItem('bankUser',user)\r\n        localStorage.setItem('bankToken',result.value.token)\r\n        fetch(\"http://localhost:8090/TotalControl/v2/devices?q=all&token=\"+result.value.token, requestOptions)\r\n        .then(response => response.json())\r\n        .then(result => {\r\n          console.log(result.ids)\r\n          let loginContainer = document.getElementsByClassName('bankLoginForm')[0]\r\n          document.getElementsByClassName('bankLoginForm')[0].innerHTML=\"\"\r\n          result.ids.forEach((item)=>{\r\n            let button = document.createElement('button')\r\n            let device = document.createTextNode(item)\r\n            button.appendChild(device)\r\n            button.setAttribute('id',item)\r\n            button.setAttribute('class','chooseDevices')\r\n            loginContainer.appendChild(button)\r\n            button.addEventListener('click',function(){\r\n              localStorage.setItem('deviceName',button.getAttribute('id'))\r\n              if(!localStorage.getItem(button.getAttribute('id'))){\r\n                localStorage.setItem(button.getAttribute('id'),0)\r\n              }\r\n              setTimeout(function(){\r\n                window.location.href='/'\r\n              },500)\r\n            })\r\n          })\r\n        })\r\n        .catch(error => console.log('error', error));\r\n        // window.location.reload()\r\n      }else{\r\n        localStorage.setItem('bankUser',\"Vui Long Dang Nhap Lai\")\r\n        alert(\"Đăng Nhập Không Chính Xác\")\r\n        window.location.reload()\r\n      }\r\n    }).catch(error => console.log('error', error));\r\n  }\r\n}\r\n\r\nexport default bankLogin\r\n// 48bbd5f5a95477f3053c28b73bce2f20"],"mappings":"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"},"metadata":{},"sourceType":"module"}