{"ast":null,"code":"import waitForElm from \"../middlewares/waitForElm\";\nimport getHistory from \"./history.controller\";\nimport dateValue from \"../constant/date\";\nimport bidvBillPrint from \"./bidvBillPrint\";\nimport vietinBillPrint from \"./vietinBillPrint\";\nconst billControler = () => {\n  waitForElm('#startTime').then(() => {\n    document.getElementById('startTime').value = new Date(dateValue.currentStartDay).getFullYear() + \"-\" + (new Date(dateValue.currentStartDay).getMonth() + 1) + '-' + new Date(dateValue.currentStartDay).getDate() + 'T00:00:01';\n    document.getElementById('endTime').value = new Date(dateValue.currentEndDay).getFullYear() + \"-\" + (new Date(dateValue.currentStartDay).getMonth() + 1) + '-' + new Date(dateValue.currentStartDay).getDate() + 'T23:59:59';\n  });\n  waitForElm('.billPrinter').then(() => {\n    let billPrnt = document.querySelectorAll('.billPrinter');\n    billPrnt.forEach(el => {\n      let jsonpars = JSON.parse(el.getAttribute('data-id'));\n      let transBank = String(jsonpars.approvereason).toLowerCase();\n      if (transBank.indexOf(\"bidv\") == 0) {\n        bidvBillPrint();\n      }\n      if (transBank.indexOf(\"msb\") == 0) {\n        vietinBillPrint();\n      }\n    });\n    let billingContentBidv = document.getElementsByClassName('bidv')[0];\n    let billingContentVietin = document.getElementsByClassName('vietin')[0];\n    let billingContentVcb = document.getElementsByClassName('vcb')[0];\n    let closeBill = function () {\n      billingContentBidv.style.opacity = '0';\n      billingContentBidv.style.zIndex = '-1';\n      billingContentVietin.style.opacity = '0';\n      billingContentVietin.style.zIndex = '-1';\n      billingContentVcb.style.opacity = '0';\n      billingContentVcb.style.zIndex = '-1';\n    };\n\n    // Click Close Bill\n    document.addEventListener('click', e => {\n      if (e.path[0].getAttribute('class') == 'cancelPrnt') {\n        closeBill();\n        console.log('Click Cancel');\n      }\n    });\n\n    // Press Esc to Close Bill\n    window.addEventListener('keydown', e => {\n      if (e.key === 'Escape') {\n        closeBill();\n        console.log('Esc Cancel');\n      }\n    });\n  });\n  waitForElm('.transHistory').then(() => {\n    function downloadCSVFile(csv, filename) {\n      var csv_file, download_link;\n      csv_file = new Blob([csv], {\n        type: \"text/csv\"\n      });\n      download_link = document.createElement(\"a\");\n      download_link.download = filename;\n      download_link.href = window.URL.createObjectURL(csv_file);\n      download_link.style.display = \"none\";\n      document.body.appendChild(download_link);\n      download_link.click();\n    }\n    document.getElementById(\"download-button\").addEventListener(\"click\", function () {\n      var html = document.getElementsByClassName(\"tableData\")[0].outerHTML;\n      htmlToCSV(html, \"TaiBieu.csv\");\n    });\n    let submitForm = document.getElementById('historyFormSubmit');\n    submitForm.addEventListener('click', () => {\n      let starTime = document.getElementById('startTime').value;\n      let endTime = document.getElementById('endTime').value;\n      let playerChoices = document.getElementById('playerChoices').value;\n      let player = document.getElementById('player').value;\n      if (endTime != '' && starTime != '') {\n        getHistory(new Date(starTime).getTime(), new Date(endTime).getTime(), playerChoices, player, 0);\n      } else {\n        alert('Vui lòng nhập ngày tháng');\n      }\n    });\n    function htmlToCSV(html, filename) {\n      var data = [];\n      var rows = document.querySelectorAll(\"table tr\");\n      for (var i = 0; i < rows.length; i++) {\n        var row = [],\n          cols = rows[i].querySelectorAll(\"td, th\");\n        for (var j = 0; j < cols.length; j++) {\n          row.push(cols[j].innerText);\n        }\n        data.push(row.join(\",\"));\n      }\n      downloadCSVFile(data.join(\"\\n\"), filename);\n    }\n  });\n};\nexport default billControler;","map":{"version":3,"names":["waitForElm","getHistory","dateValue","bidvBillPrint","vietinBillPrint","billControler","then","document","getElementById","value","Date","currentStartDay","getFullYear","getMonth","getDate","currentEndDay","billPrnt","querySelectorAll","forEach","el","jsonpars","JSON","parse","getAttribute","transBank","String","approvereason","toLowerCase","indexOf","billingContentBidv","getElementsByClassName","billingContentVietin","billingContentVcb","closeBill","style","opacity","zIndex","addEventListener","e","path","console","log","window","key","downloadCSVFile","csv","filename","csv_file","download_link","Blob","type","createElement","download","href","URL","createObjectURL","display","body","appendChild","click","html","outerHTML","htmlToCSV","submitForm","starTime","endTime","playerChoices","player","getTime","alert","data","rows","i","length","row","cols","j","push","innerText","join"],"sources":["D:/JOB CODE/autobank/789BET/vietin/autobank/src/controllers/billController.js"],"sourcesContent":["import waitForElm from \"../middlewares/waitForElm\";\r\nimport getHistory from \"./history.controller\";\r\nimport dateValue from \"../constant/date\";\r\nimport bidvBillPrint from \"./bidvBillPrint\";\r\nimport vietinBillPrint from \"./vietinBillPrint\";\r\n\r\nconst billControler = () => {\r\n    waitForElm('#startTime').then(()=>{\r\n        document.getElementById('startTime').value = new Date(dateValue.currentStartDay).getFullYear()+\"-\"+(new Date(dateValue.currentStartDay).getMonth()+1)+'-'+(new Date(dateValue.currentStartDay).getDate())+'T00:00:01'\r\n        document.getElementById('endTime').value = new Date(dateValue.currentEndDay).getFullYear()+\"-\"+(new Date(dateValue.currentStartDay).getMonth()+1)+'-'+(new Date(dateValue.currentStartDay).getDate())+'T23:59:59'\r\n      })\r\n      \r\n      waitForElm('.billPrinter').then(()=>{\r\n        \r\n        let billPrnt = document.querySelectorAll('.billPrinter')\r\n        billPrnt.forEach((el)=>{\r\n          let jsonpars = JSON.parse(el.getAttribute('data-id'))\r\n          let transBank = String(jsonpars.approvereason).toLowerCase();\r\n\r\n          if(transBank.indexOf(\"bidv\") == 0) {\r\n            bidvBillPrint();\r\n          }\r\n\r\n          if(transBank.indexOf(\"msb\") == 0) {\r\n            vietinBillPrint();\r\n          }\r\n      })\r\n        \r\n\r\n        let billingContentBidv = document.getElementsByClassName('bidv')[0]\r\n        let billingContentVietin = document.getElementsByClassName('vietin')[0]\r\n        let billingContentVcb = document.getElementsByClassName('vcb')[0]\r\n\r\n\r\n        let closeBill = function() {\r\n          billingContentBidv.style.opacity='0'\r\n          billingContentBidv.style.zIndex='-1'\r\n          billingContentVietin.style.opacity='0'\r\n          billingContentVietin.style.zIndex='-1'\r\n          billingContentVcb.style.opacity='0'\r\n          billingContentVcb.style.zIndex='-1'\r\n        }\r\n\r\n        // Click Close Bill\r\n        document.addEventListener('click', e => {\r\n          if(e.path[0].getAttribute('class') == 'cancelPrnt') {\r\n            closeBill();\r\n            console.log('Click Cancel')\r\n          }\r\n        })\r\n\r\n        // Press Esc to Close Bill\r\n        window.addEventListener('keydown', e => {\r\n          if(e.key === 'Escape') {\r\n            closeBill();\r\n            console.log('Esc Cancel')\r\n          }\r\n        })\r\n      })\r\n      \r\n      waitForElm('.transHistory').then(()=>{\r\n        function downloadCSVFile(csv, filename) {\r\n          var csv_file, download_link;\r\n          csv_file = new Blob([csv], {type: \"text/csv\"});\r\n          download_link = document.createElement(\"a\");\r\n          download_link.download = filename;\r\n          download_link.href = window.URL.createObjectURL(csv_file);\r\n          download_link.style.display = \"none\";\r\n          document.body.appendChild(download_link);\r\n          download_link.click();\r\n        }\r\n        document.getElementById(\"download-button\").addEventListener(\"click\", function () {\r\n          var html = document.getElementsByClassName(\"tableData\")[0].outerHTML;\r\n          htmlToCSV(html, \"TaiBieu.csv\");\r\n        });\r\n      \r\n        let submitForm = document.getElementById('historyFormSubmit')\r\n        submitForm.addEventListener('click', ()=>{\r\n          let starTime = document.getElementById('startTime').value\r\n          let endTime = document.getElementById('endTime').value\r\n          let playerChoices = document.getElementById('playerChoices').value\r\n          let player = document.getElementById('player').value\r\n          if(endTime!='' && starTime!=''){\r\n            getHistory(new Date(starTime).getTime(),new Date(endTime).getTime(),playerChoices,player,0)\r\n          }else{\r\n            alert('Vui lòng nhập ngày tháng')\r\n          }\r\n        })\r\n      \r\n        function htmlToCSV(html, filename) {\r\n          var data = [];\r\n          var rows = document.querySelectorAll(\"table tr\");\t\t\t\t\t\r\n          for (var i = 0; i < rows.length; i++) {\r\n            var row = [], cols = rows[i].querySelectorAll(\"td, th\");\t\t\t\t\t\t\r\n            for (var j = 0; j < cols.length; j++) {\r\n              row.push(cols[j].innerText);\r\n            }\r\n            data.push(row.join(\",\"));\t\t\r\n          }\r\n          downloadCSVFile(data.join(\"\\n\"), filename);\r\n        }\r\n      })\r\n}\r\n\r\nexport default billControler;"],"mappings":"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"},"metadata":{},"sourceType":"module"}